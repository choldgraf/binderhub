
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1. Create your cloud resources &#8212; BinderHub 0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://cdn.rawgit.com/choldgraf/sphinx-copybutton/master/_static/copybutton.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/choldgraf/sphinx-copybutton/master/_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>
    <link rel="shortcut icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Set up the container registry" href="setup-registry.html" />
    <link rel="prev" title="BinderHub" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class='prev-next-top'>
    
     <a class='left-prev' href="index.html" title="previous chapter">Previous</a>
     <a class='right-next' href="setup-registry.html" title="next chapter">Next</a>
  <div style='clear:both;'></div>

  </div>

  
  <div class="section" id="create-your-cloud-resources">
<span id="create-cluster"></span><h1>1. Create your cloud resources<a class="headerlink" href="#create-your-cloud-resources" title="Permalink to this headline">¶</a></h1>
<p>BinderHub is built to run on top of Kubernetes, a distributed cluster manager.
It uses a JupyterHub to launch/manage user servers, as well as a
docker registry to cache images.</p>
<p>To create your own BinderHub, you’ll first need to set up a properly
configured Kubernetes Cluster on the cloud, and then configure the
various components correctly. The following instructions will assist you
in doing so.</p>
<div class="section" id="setting-up-kubernetes-on-google-cloud">
<h2>1.1. Setting up Kubernetes on <a class="reference external" href="https://cloud.google.com/">Google Cloud</a><a class="headerlink" href="#setting-up-kubernetes-on-google-cloud" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BinderHub is built to be cloud agnostic, and can run on various cloud
providers (as well as bare metal). However, here we only provide
instructions for Google Cloud as it has been the most extensively-tested.
If you would like to help with adding instructions for other cloud
providers, <a class="reference external" href="https://github.com/jupyterhub/binderhub/issues">please contact us</a>!</p>
</div>
</div>
<div class="section" id="install-helm">
<h2>1.2. Install Helm<a class="headerlink" href="#install-helm" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://helm.sh/">Helm</a>, the package manager for Kubernetes, is a useful tool
to install, upgrade and manage applications on a Kubernetes cluster. We will be
using Helm to install and manage JupyterHub on our cluster.</p>
<p>Helm works by initializing itself both locally (on your computer) and remotely
(on your kubernetes cluster). When you run <code class="docutils literal notranslate"><span class="pre">helm</span></code> commands, your local helm
client sends instructions to the <code class="docutils literal notranslate"><span class="pre">Tiller</span></code>, which exists on your
Kubernetes cluster, and is controlled by the server-side <code class="docutils literal notranslate"><span class="pre">helm</span></code> install.</p>
<div class="section" id="installation">
<h3>1.2.1. Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>The simplest way to install helm is to run Helm’s installer script at a
terminal:</p>
<blockquote>
<div><div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">helm</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">get</span> <span class="o">|</span> <span class="n">bash</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference external" href="https://github.com/kubernetes/helm/blob/master/docs/install.md">Alternative methods for helm installation</a>
exist if you prefer to install without using the script.</p>
</div>
<div class="section" id="initialization">
<span id="helm-rbac"></span><h3>1.2.2. Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<p>After installing helm on your machine, initialize helm on your Kubernetes
cluster. At a terminal for your local machine (or within an interactive cloud
shell from your provider), enter:</p>
<ol class="arabic">
<li><p class="first">Set up a <a class="reference external" href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">ServiceAccount</a>
for use by <code class="docutils literal notranslate"><span class="pre">Tiller</span></code>, the server side component of <code class="docutils literal notranslate"><span class="pre">helm</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl --namespace kube-system create serviceaccount tiller
</pre></div>
</div>
<p><strong>Azure AKS</strong>: If you’re on Azure AKS, you should now skip directly to step 3.**</p>
</li>
<li><p class="first">Give the <code class="docutils literal notranslate"><span class="pre">ServiceAccount</span></code> <a class="reference external" href="https://kubernetes.io/docs/admin/authorization/rbac/">RBAC</a> full permissions to
manage the cluster.</p>
<p>While most clusters have RBAC enabled and you need this
line, you <strong>must</strong> skip this step if your kubernetes cluster does not have
RBAC enabled (for example, if you are using Azure AKS).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl create clusterrolebinding tiller --clusterrole cluster-admin --serviceaccount<span class="o">=</span>kube-system:tiller
</pre></div>
</div>
</li>
<li><p class="first">Set up Helm on the cluster.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm init --service-account tiller
</pre></div>
</div>
</li>
</ol>
<p>This command only needs to run once per Kubernetes cluster.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The local and remote version of <code class="docutils literal notranslate"><span class="pre">helm</span></code> must be the same in order to
ensure they can talk to each other. If you wish to run <code class="docutils literal notranslate"><span class="pre">helm</span></code> commands
from a <em>new</em> computer than the one used to run the commands above, you
must re-initialize it by running the following modified version of
the <code class="docutils literal notranslate"><span class="pre">init</span></code> command:</p>
<p><code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">init</span> <span class="pre">--client-only</span> <span class="pre">--service-account</span> <span class="pre">tiller</span></code></p>
<p class="last">This will initialize <code class="docutils literal notranslate"><span class="pre">helm</span></code> locally, according to the version that is
running remotely on the cluster. Note that this requires <code class="docutils literal notranslate"><span class="pre">kubectl</span></code>
to point to the correct kubernetes cluster. See <a class="reference external" href="https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/">the kubernetes context
manager</a>
for more details.</p>
</div>
</div>
<div class="section" id="verify">
<h3>1.2.3. Verify<a class="headerlink" href="#verify" title="Permalink to this headline">¶</a></h3>
<p>You can verify that you have the correct version and that it installed
properly by running:</p>
<blockquote>
<div><div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">helm</span> <span class="n">version</span>
</pre></div>
</div>
</div></blockquote>
<p>It should provide output like:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Client: <span class="p">&amp;</span>version.Version<span class="o">{</span>SemVer:<span class="s2">&quot;v2.8.1&quot;</span>, GitCommit:<span class="s2">&quot;46d9ea82e2c925186e1fc620a8320ce1314cbb02&quot;</span>, GitTreeState:<span class="s2">&quot;clean&quot;</span><span class="o">}</span>
Server: <span class="p">&amp;</span>version.Version<span class="o">{</span>SemVer:<span class="s2">&quot;v2.8.1&quot;</span>, GitCommit:<span class="s2">&quot;46d9ea82e2c925186e1fc620a8320ce1314cbb02&quot;</span>, GitTreeState:<span class="s2">&quot;clean&quot;</span><span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Make sure you have at least version 2.8.1!</p>
<p>If you receive an error that the Server is unreachable, do another <code class="docutils literal notranslate"><span class="pre">helm</span> <span class="pre">version</span></code>
in 15-30 seconds, and it should display the Server version.</p>
</div>
<div class="section" id="secure-helm">
<h3>1.2.4. Secure Helm<a class="headerlink" href="#secure-helm" title="Permalink to this headline">¶</a></h3>
<p>Ensure that <a class="reference external" href="https://engineering.bitnami.com/articles/helm-security.html">tiller is secure</a> from access inside the cluster:</p>
<blockquote>
<div><div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kubectl</span> <span class="o">--</span><span class="n">namespace</span><span class="o">=</span><span class="n">kube</span><span class="o">-</span><span class="n">system</span> <span class="n">patch</span> <span class="n">deployment</span> <span class="n">tiller</span><span class="o">-</span><span class="n">deploy</span> <span class="o">--</span><span class="nb">type</span><span class="o">=</span><span class="n">json</span> <span class="o">--</span><span class="n">patch</span><span class="o">=</span><span class="s1">&#39;[{&quot;op&quot;: &quot;add&quot;, &quot;path&quot;: &quot;/spec/template/spec/containers/0/command&quot;, &quot;value&quot;: [&quot;/tiller&quot;, &quot;--listen=localhost:44134&quot;]}]&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>Now that you’ve installed Kubernetes and Helm, it’s time to <a class="reference internal" href="setup-registry.html#setup-registry"><span class="std std-ref">Set up the container registry</span></a>.</p>
</div>
</div>
</div>


  <div class='prev-next-bottom'>
    
     <a class='left-prev' href="index.html" title="previous chapter">BinderHub</a>
     <a class='right-next' href="setup-registry.html" title="next chapter">2. Set up the container registry</a>
  <div style='clear:both;'></div>

  </div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="index.html">BinderHub</a></h1>



<p class="blurb">A project to build and serve Binders</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jupyterhub&repo=binderhub&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<h3>Table of Contents</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Create your cloud resources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-kubernetes-on-google-cloud">1.1. Setting up Kubernetes on Google Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-helm">1.2. Install Helm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="setup-registry.html">2. Set up the container registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup-binderhub.html">3. Set up BinderHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="turn-off.html">4. Tear down your Binder deployment</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. The BinderHub Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug.html">2. Debugging BinderHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="customizing.html">3. Customizing your BinderHub deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">4. BinderHub API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="known-deployments.html">5. BinderHub Deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/ref-index.html">6. Configuration and Source Code Reference</a></li>
</ul>


<div class="relations">
<h3>Navigation</h3>
<ul>
  <li><a href="index.html">Documentation Home</a><ul>
  <li><a href="index.html" title="Previous">Previous topic</a></li>
  <li><a href="setup-registry.html" title="Next">Next topic</a></li>
  </ul>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/create-cloud-resources.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, The Jupyter Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/create-cloud-resources.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>